<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Jason Hallen">
<meta name="keywords" content="Jason Hallen, blog, computer music, algorithmic music, electronic music, csound, synthesis, experimental music, website, static site generator, node.js, Staticman, comments, Heroku, GitHub, authentication, reCAPTCHA">
<meta name="description" content="">
<!-- <title></title> -->

<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9FW0V3NTDJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9FW0V3NTDJ');
</script>
<link href="/images/favicon.ico" rel="shortcut icon">
<link href="https://fonts.googleapis.com/css?family=Josefin+Slab" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
<link rel="stylesheet" href="/style.css"><title>Update: Csound, Node.js &amp; Electron</title></head>

<body>
    <div id="header">
        <span id="jason-hallen">
            <a href="/">Jason Hallen</a>
        </span>
        <div id="nav">
            <ul>
                <li class="active"><a href="/">Blog</a></li>
                <li><a href="/music">Music</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </div>        
    </div>
    <div id="page-content"><div id="post-section"><h2>Update: Csound, Node.js &amp; Electron</h2><span class="muted date">August 28, 2022</span>

<p>I've spent the last few weeks trying to build a Csound GUI with Node.js and Electron.  My immediate goal is to revive my <a href="LINK">Mell Fark project</a>, but my longer-term goal is to find a framework to build other Csound GUIs with going forward.  Alas, I suspect Node.js and Electron won't be that framework.  As much as I enjoy working with HTML and CSS for rendering GUIs, I've grown frustrated with JavaScript and the browser environment.  </p>

<h3 id="the-search-for-a-gui-framework">The Search for a GUI Framework</h3>
<p>At this stage in my computer music practice I'm searching for a framework to build GUIs for Csound projects.  Specifically, I'm interested in building <strong>real-time interactive</strong> programs that will allow me to perform music rendered by Csound.</p>
<p>My blog documents my journey with Csound GUIs up until now.</p>
<ul>
<li>The <a href="LINK">James Tenney project</a> began with Python scripts generating algorithmic pieces and ended with building my first GUI in <a href="LINK">CsoundQt</a>.</li>
<li>The <a href="LINK">drum machine project</a> and <a href="LINK">Mark Fell project</a> saw me building GUIs in <a href="LINK">Cabbage</a> for the first time.</li>
<li>I briefly explored Python and PySimpleGUI to build a GUI for the <a href="LINK">music generator project</a>.</li>
<li>I dove into Web Csound and p5.js for the <a href="LINK">looper project</a>.</li>
</ul>
<p>After taking off a year off from computer music I've returned to the Mark Fell project, now renamed the <a href="LINK">Mell Fark project</a>.  This time I'd like to focus on building a performant GUI.</p>
<h3 id="framework-requirements">Framework Requirements</h3>
<p>Here's what I'm looking for in a GUI framework:</p>
<ul>
<li>Get outside of Csound IDEs like CsoundQt, Cabbage, or Blue [LINKS]<ul>
<li>Great IDEs, but opinionated, not fully customizable, and focus on working within Csound rather than scripting languages.  I wanted to use a scripting language to control Csound.</li>
</ul>
</li>
<li>Desktop app not web app<ul>
<li>Move out of Web Csound, p5.js, and WASM world</li>
<li>Work directly with Csound running on local processor</li>
</ul>
</li>
<li>Customize the design<ul>
<li>Continue to use HTML/CSS/JS for rendering GUI</li>
</ul>
</li>
<li>Avoid C++<ul>
<li>Use JavaScript or Python</li>
</ul>
</li>
<li>Real-time performance and concurrency</li>
<li>Node.js and Electron good choices</li>
</ul>
<h3 id="nodejs--electron">Node.js &amp; Electron</h3>
<ul>
<li><code>csound-api</code> by Nate Whetsell</li>
</ul>
<h3 id="frustrations-with-electron">Frustrations with Electron</h3>
<p>Let me make one thing very clear.  It's very likely that Node.js/Electron are great environments for building Csound GUIs, but as a novice programmer I don't have the knowledge and skills to make it work for my needs.  So please don't take this blog post to mean that it's not worth pursuing Node.js/Electron.  In fact, please leave a comment to point out where I could have approached Node.js/Electron better.</p>
<ul>
<li>Comes with its own Node.js, which conflicts with the one on your computer<ul>
<li>Causes problems with package dependencies</li>
<li>Recompiling packages against the Node.js in Electron</li>
</ul>
</li>
<li>Complications with MacBook Pro M1 chips<ul>
<li>Couldn't run NW.js due to this</li>
</ul>
</li>
<li>Separation of main process from renderer process<ul>
<li>Inter-process communication is tedious</li>
</ul>
</li>
</ul>
<h3 id="getting-high-resolution-data-from-csound">Getting High Resolution Data from Csound</h3>
<p>The biggest frustration I had with Node.js is getting high resolution data from Csound.  I want to animate a volume meter, and the more values per second you can read the smoother the animation.</p>
<ul>
<li>Bottleneck getting data out of the Csound API via channels.</li>
<li>Switched to `performAsyncKsmps and got 26 values/second.<ul>
<li>Still got bottlenecked in the browser</li>
</ul>
</li>
<li>Switched to OSC to send data<ul>
<li>Major resolution improvement, but still bottlenecked in browser</li>
</ul>
</li>
<li>Thought it was the IPC communication, so stripped it down to an Express server.<ul>
<li>Still got bottlenecked in the browser</li>
<li>My best guess is this has to do with <code>requestAnimationFrame</code> which seems to yield to the OSC server 10 times per second.</li>
</ul>
</li>
</ul>
<h3 id="moving-on-from-nodejs">Moving on from Node.js</h3>
<p>I really wanted to love Node.js and Electron.  The whole promise of Electron is that you can conveniently port a web app to a desktop app.  However, it was an uphill battle for me.  I never felt like I understood what was actually happening in Node.js.  It was a discouraging experience.  At times I thought I wasn't up to the task of building a Csound GUI framework.</p>
<p>After about three weeks I decided it was time to move on from Node.js and Electron for this project.  I briefly considered (Sciter)[LINK] because it allows you to write the program logic in whatever language you'd like and still use HTML/CSS/JS for the GUI.  However, I was tired of the complications of the browser environment.</p>
<p>I revisited an <a href="LINK">old post</a> on the Csound Forum where I asked for advice about building Csound GUIs.  Rory Walsh, the patron saint of Csound newbies, suggested Qt as a good option.  I had resisted Qt because I had this idea that it was an overwhelming framework that was too advanced for me.  But at this point, any other framework seemed more appealing to me than Electron, so I've been working with PyQt5 for the past several days.</p>
<p>At some point soon I'll post about my experiences with PyQt5, but for now I'll say that within three days I had already made more progress on my GUI than three weeks with Node.js and Electron.  In fact, I've already found a straightforward way to animate a volume meet with over 100 values/second.  Now I can really get to work.</p>
<div id="prev-next-container"><span class="older-button"><a href="/blog/update-now-with-staticman-comments" class="readmore">Older</a></span></div></div><div id="comments-section"><div id="comment-form"><form class="js-form" method="post" action="https://jasonhallen-staticman.herokuapp.com/v3/entry/github/jasonhallen/jasonhallen.github.io/main/comments">
    
    <!-- <input type="hidden" name="options[origin]" value="{{ page.url | absolute_url }}"> -->
    <input type="hidden" name="options[parent]" value="https://jasonhallen.com/blog/update-building-csound-guis-with-nodejs.html">
    <!-- <input name="options[redirect]" type="hidden" value="https://jasonhallen.com/thanks"> -->
    <input type="hidden" id="comment-replying-to-uid" name="fields[replying_to_uid]" value="">
    <input type="hidden" name="options[slug]" value="update-building-csound-guis-with-nodejs">
    
    <!-- reCaptcha -->
    <input type="hidden" name="options[reCaptcha][siteKey]" value="6LcsNJIhAAAAAIF7ND_Y8QPGuocbqYoe3LPpNWPI">
    <input type="hidden" name="options[reCaptcha][secret]" value="J/1tx/gxjjcF4Qw17kZ0QUhUK9xnotL31qIetlT0EGmt7rZEyYfRDfKKHit/hxajHF4EV898b9pWqF0nbhZVa+j+AmxyMrcJTvP7lD0Fvfdk6fK/W/6OMe1q3dOROo/HIF5lLmDcdFMKc9L1Y3T0wDNuStn2lvL3v2ECnajXG5/CSurNFRnFq1k1iwGvHn5XLeypNgz08MKk+5E5f55DyEeRwxtLu2wAaiyIBISpboEas5v9OZpPoclYnYWneAiX0CeccxGSL3EyxJ3CCD9GSJsFrrOYAPRRujw4hXmRzAzzJunSLd1V4icFPaqlsqWYAGYMehQeeHlV77MAcg7gxeSJv9GVyrfbtg82yhsASgtkGhtUFEmN7AenM1XZs4TDqUUxP01o9Gj/oYmfGQUdr734IVewVQkcm65zF092ZSeeTefX/5s8cZedPiFK6bvLylbFxu/s4kLG482H/ZU64QdSIyrDuSzOISbZo+0Yd9OlElvkgeZML6+pyjd8SrNjxfCSA1bgOhb+3aGfXKVw+JxinWCizR2JB6Q/FOZzEa4I0aefzOeGwNK8XGC/vHzmt/58KFeEDNTpse77cHywvoT74XVIciJcPUvTrq6rAw5tkaekmuDX03Trefxo+pAMBXqj8wy06mgYsg721XNd8IpE+Qk7wPs/Dv8BfEhH6sc=">
    
    <h2 id="comment-form-header">Leave a Comment</h2>

    <div class="textfield">
        <p>Your email address will not be published. Required fields are marked *</p>
        <label for="comment-form-message"><strong>Comment *</strong></label>
        <textarea class="textfield__input" name="fields[message]" type="text" id="comment-form-message" placeholder="[You can use Markdown.]" required="" rows="6"></textarea>
    </div>

    <div class="textfield">
        <label for="comment-form-name"><strong>Name *</strong></label>
        <br>
        <input class="textfield__input" name="fields[name]" type="text" id="comment-form-name" required="">
    </div>
    
    <div class="textfield">
        <label for="comment-form-email"><strong>Email</strong></label>
        <br>
        <input class="textfield__input" name="fields[email]" type="email" id="comment-form-email">
    </div>
    
    <div class="textfield hp">
    <label for="hp">
        <input class="textfield__input" name=" hp" id="hp" type="text" placeholder="Leave blank">
    </label>
    </div>

    <div id="reCaptcha" class="g-recaptcha" data-sitekey="6LcsNJIhAAAAAIF7ND_Y8QPGuocbqYoe3LPpNWPI"></div>

    <div id="submit-cancel-buttons">
        <button class="readmore" id="comment-form-submit">
        Submit
        </button>

        <button type="button" class="readmore" id="cancel-comment-reply-link" style="display: none">
        Cancel
        </button>
        <!-- <p id="recaptcha-fine-print"><small>This site is protected by reCAPTCHA and the Google <a href="https://policies.google.com/privacy">Privacy Policy</a> and <a href="https://policies.google.com/terms">Terms of Service</a> apply.</small></p> -->
    </div>

</form>

<div id="modal-wrapper" style="display: none;">
    <article class="modal">
        <img class="modal-image" src="">
            <div id="modal-text-wrapper">
            <h3 class="modal-title js-modal-title"></h3>
            <div class="mdl-card__supporting-text js-modal-text"></div>
            <div class="mdl-card__actions mdl-card--border">
                <button class="button readmore mdl-button--colored mdl-js-button mdl-js-ripple-effect js-close-modal">
                    Close
                </button>
            </div>
        </div>
    </article>
</div>

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none">
    <symbol id="icon-loading" viewBox="149.8 37.8 499.818 525"><path d="M557.8 187.8c13.8 0 24.601-10.8 24.601-24.6S571.6 138.6 557.8 138.6s-24.6 10.8-24.6 24.6c0 13.2 10.8 24.6 24.6 24.6zm61.2 90.6c-16.8 0-30.6 13.8-30.6 30.6s13.8 30.6 30.6 30.6 30.6-13.8 30.6-30.6c.6-16.8-13.2-30.6-30.6-30.6zm-61.2 145.2c-20.399 0-36.6 16.2-36.6 36.601 0 20.399 16.2 36.6 36.6 36.6 20.4 0 36.601-16.2 36.601-36.6C595 439.8 578.2 423.6 557.8 423.6zM409 476.4c-24 0-43.2 19.199-43.2 43.199s19.2 43.2 43.2 43.2 43.2-19.2 43.2-43.2S433 476.4 409 476.4zM260.8 411c-27 0-49.2 22.2-49.2 49.2s22.2 49.2 49.2 49.2 49.2-22.2 49.2-49.2-22.2-49.2-49.2-49.2zm-10.2-102c0-27.6-22.8-50.4-50.4-50.4-27.6 0-50.4 22.8-50.4 50.4 0 27.6 22.8 50.4 50.4 50.4 27.6 0 50.4-22.2 50.4-50.4zm10.2-199.8c-30 0-54 24-54 54s24 54 54 54 54-24 54-54-24.6-54-54-54zM409 37.8c-35.4 0-63.6 28.8-63.6 63.6S374.2 165 409 165s63.6-28.8 63.6-63.6-28.2-63.6-63.6-63.6z"></path>
    </symbol>
</svg></div></div></div>
    <script src="/comments.js"></script>


<script src="https://www.google.com/recaptcha/api.js?render=reCAPTCHA_site_key"></script>
</body><!-- <script src="https://www.google.com/recaptcha/api.js" async defer></script> --></html>