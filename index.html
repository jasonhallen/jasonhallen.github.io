<!DOCTYPE html>
<html lang="en"><head>
    <!-- <meta charset="utf-8"/> -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Jason Hallen">
<meta name="keywords" content="Jason Hallen, blog, computer music, algorithmic music, electronic music, csound, synthesis, experimental music, Jason Hallen, computer music, biography, about">
<meta name="description" content="">
<!-- <title></title> -->

<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9FW0V3NTDJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9FW0V3NTDJ');
</script>
<link href="/images/favicon.ico" rel="shortcut icon">
<link href="https://fonts.googleapis.com/css?family=Josefin+Slab" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet"> -->
<link rel="stylesheet" href="/style.css"></head>

<body onresize="update_button_position()">
    <div id="header" class="home" "="">
        <span id="jason-hallen">
            <a href="/">Jason Hallen</a>
        </span>
        <div id="nav">
            <ul>
                <li><a href="/notes">Notes</a></li>
                <li><a href="/output">Output</a></li>
                <li><a href="/info">Info</a></li>
            </ul>
        </div>        
    </div>
    <!-- <div id='page-content'>
    </div> -->
    <div id="home_video_container">
        <video class="home_video" muted="" onloadeddata="update_button_position()" onended="change_video(ended = true)">
            Your browser does not support the video element.
            <source src="/video/anim_transitions_2024_2_28.mp4" type="video/mp4">
        </video>
    </div>
    <!-- <button id="previous" class='media_button' onclick="">&#x23EE;</button> -->
    <!--  play = &#9658;, next = &#10227; -->
    <button id="next" class="media_button hidden" onclick="change_video()">*</button>
    <button id="play_pause" class="media_button hidden" onclick="toggle_play()">&gt;</button>
    <script>
        function update_button_position() {
            bottom_position = document.getElementsByClassName('home_video')[0].getBoundingClientRect().bottom
            right_position = document.getElementsByClassName('home_video')[0].getBoundingClientRect().right
            media_buttons = Array.from(document.getElementsByClassName('media_button'))
            var i = 1
            media_buttons.forEach((element) => {
                element.style.top = bottom_position - 50 + "px"
                element.style.left = right_position - 50 * i + "px"
                element.classList.remove('hidden')
                i += 1
            })
        }

        function toggle_play() {
            var video = document.getElementsByClassName('home_video')[0]
            if (video.paused) {
                var icon = document.getElementById('play_pause')
                icon.innerHTML = "="
                icon.classList.add('rotate')
                video.play()
            } else {
                var icon = document.getElementById('play_pause')
                icon.innerHTML = ">"
                icon.classList.remove('rotate')
                video.pause()
            }
        }

        function change_video(ended = false) {
            console.log(ended)
            var vid_array = [
            '/video/mosh_kallie_annie_2024_4_15.mp4',    
            '/video/mosh_kallie_horizontal11_2024_4_15.mp4',
            '/video/mosh_kallie_horizontal14_2024_4_15.mp4',
            '/video/mosh_kallie_average8_2024_4_15.mp4',
            '/video/mosh_output4_2024_2_27.mp4',
            '/video/anim_horizontal_2024_2_27.mp4',
            '/video/anim_transitions_2024_2_28.mp4',
            '/video/anim_pan_skew_2024_3_20.mp4'
            ]
            var home_video_container = document.getElementById('home_video_container')
            var old_video = document.getElementsByClassName('home_video')[0]
            var new_video = document.createElement('video')
            new_video.className = 'home_video'
            video_source = vid_array[Math.floor(Math.random() * vid_array.length)]
            // while (!old_video.src.includes(video_source)) {
            //     video_source = vid_array[Math.floor(Math.random() * vid_array.length)]
            // }
            // console.log(video_source, old_video.getElementsByTagName("source")[0].src, !old_video.src.includes(video_source))
            new_video.src = video_source
            new_video.controls = false
            // new_video.loop = true
            if (ended === true) {
                new_video.autoplay = true
            } else {
                new_video.autoplay = !old_video.paused
            }
            new_video.muted = true
            new_video.preload = 'metadata'
            new_video.onended = (event) => change_video(ended = true)
            // add_onclick(new_video)
            new_video.addEventListener("loadeddata", (event) => {
                document.getElementsByClassName('home_video')[0].remove()
                this.currentTime = 3
                update_button_position()
            })
            new_video.addEventListener("loadedmetadata", (event) => {
                this.currentTime = 4
            })
            home_video_container.appendChild (new_video);
        }
        function add_onclick(video) {
            video.onclick = change_video
        }

        window.onresize = update_button_position
    </script>


</body></html>